<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, interactive-widget=resizes-content">
    <meta name="referrer" content="origin">
    <title>AI Document Assistant</title>
    <meta name="description" content="AI-powered document assistant for medical guidelines and research papers">
    <meta property="og:title" content="AI Document Assistant">
    <meta property="og:description" content="AI-powered document assistant for medical guidelines and research papers">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="AI Document Assistant">
    <meta name="twitter:description" content="AI-powered document assistant for medical guidelines and research papers">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="robot-favicon.png">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton:wght@400&display=swap" rel="stylesheet">

    <!-- External Dependencies -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- Application Styles -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/disclaimer.css">
</head>
<body>
    <!-- Document Selector Overlay (for mobile) -->
    <div class="document-selector-overlay" id="documentSelectorOverlay"></div>
    
    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay">
        <div class="mobile-menu-panel" id="mobileMenuPanel">
            <!-- Mobile Menu Header -->
            <div class="mobile-menu-header">
                <h2>Menu</h2>
                <button class="mobile-menu-close" id="mobileMenuClose" aria-label="Close menu">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>

            <!-- Document Selector Section (shown when document selector is enabled) -->
            <div class="mobile-menu-section" id="mobileMenuDocSection" style="display: none;">
                <div class="mobile-menu-section-header">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    <h3>Documents</h3>
                </div>
                <div class="mobile-menu-search">
                    <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    <input type="text" id="mobileMenuDocSearch" placeholder="Search documents..." autocomplete="off">
                </div>
                <div class="mobile-menu-doc-list" id="mobileMenuDocList">
                    <!-- Documents will be populated here -->
                </div>
            </div>

            <!-- User Menu Section (shown when user is authenticated) -->
            <div class="mobile-menu-section" id="mobileMenuUserSection" style="display: none;">
                <div class="mobile-menu-section-header">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    <h3>Account</h3>
                </div>
                <div class="mobile-menu-user-info">
                    <div class="mobile-menu-user-avatar" id="mobileMenuUserAvatar">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </div>
                    <span class="mobile-menu-user-email" id="mobileMenuUserEmail">user@example.com</span>
                </div>
                <div class="mobile-menu-links">
                    <a href="/app/dashboard" class="mobile-menu-link">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="3" width="7" height="7"></rect>
                            <rect x="14" y="3" width="7" height="7"></rect>
                            <rect x="14" y="14" width="7" height="7"></rect>
                            <rect x="3" y="14" width="7" height="7"></rect>
                        </svg>
                        Dashboard
                    </a>
                    <a href="/app/profile" class="mobile-menu-link">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                        Profile
                    </a>
                    <div class="mobile-menu-divider"></div>
                    <button class="mobile-menu-link mobile-menu-signout" id="mobileMenuSignOut">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                            <polyline points="16 17 21 12 16 7"></polyline>
                            <line x1="21" y1="12" x2="9" y2="12"></line>
                        </svg>
                        Sign Out
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <!-- Mobile Header Toggle Button -->
        <button class="mobile-header-toggle" id="mobileHeaderToggle" style="display: none;" title="Show header">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </button>

        <div class="header" id="mainHeader">
            <!-- Logo Section - Left -->
            <div class="header-logo">
                <div class="header-nav">
                    <a href="#" target="_blank" rel="noopener noreferrer" id="logoLink">
                        <img id="headerLogo" src="" alt="" style="display: none;" />
                    </a>
                </div>
            </div>

            <!-- Title and Icons Section - Center -->
            <div class="header-center">
                <div class="header-title-wrapper">
                    <h1 id="headerTitle" class="loading-text">Loading...</h1>
                    <div class="header-icons">
                        <button class="about-icon" id="aboutIcon" title="View PubMed information" style="display: none;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="m9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <path d="M12 17h.01"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <p id="headerSubtitle" class="loading-text"></p>
            </div>

            <!-- User Menu Section - Right Center -->
            <div class="header-user-menu" id="userMenuSection" style="display: none;">
                <div class="user-menu-container">
                    <button class="user-menu-btn" id="userMenuBtn" title="User Menu">
                        <div class="user-avatar">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                        </div>
                        <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="user-menu-dropdown" id="userMenuDropdown">
                        <div class="dropdown-header">
                            <span class="user-email" id="userEmail">user@example.com</span>
                        </div>
                        <div class="dropdown-menu">
                            <a href="/app/dashboard" class="menu-item">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="3" y="3" width="7" height="7"></rect>
                                    <rect x="14" y="3" width="7" height="7"></rect>
                                    <rect x="14" y="14" width="7" height="7"></rect>
                                    <rect x="3" y="14" width="7" height="7"></rect>
                                </svg>
                                Dashboard
                            </a>
                            <a href="/app/profile" class="menu-item">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="12" cy="7" r="4"></circle>
                                </svg>
                                Profile
                            </a>
                            <div class="menu-divider"></div>
                            <button class="menu-item sign-out-btn" id="signOutBtn">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                    <polyline points="16 17 21 12 16 7"></polyline>
                                    <line x1="21" y1="12" x2="9" y2="12"></line>
                                </svg>
                                Sign Out
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mobile Menu Toggle (shown on mobile when doc selector or user menu is enabled) -->
            <button class="mobile-menu-toggle" id="mobileMenuToggle" style="display: none;" aria-label="Open menu">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <!-- Document Selector Section - Right -->
            <div class="header-document-selector">
                <div class="document-selector-container" id="documentSelectorContainer" style="display: none;">
                    <button class="document-selector-btn" id="documentSelectorBtn">
                        <svg class="doc-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                        </svg>
                        <span class="current-doc-name" id="currentDocName">Select Document</span>
                        <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="document-selector-dropdown" id="documentSelectorDropdown">
                        <div class="dropdown-header">
                            <h3>Available Documents</h3>
                            <button class="close-dropdown" id="closeDropdown">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        </div>
                        <div class="dropdown-search">
                            <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="11" cy="11" r="8"></circle>
                                <path d="m21 21-4.35-4.35"></path>
                            </svg>
                            <input type="text" id="documentSearch" placeholder="Search documents..." autocomplete="off">
                        </div>
                        <div class="document-list" id="documentList">
                            <!-- Documents will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Always Visible Header Content -->
        <div class="header-content">
            <a href="#" class="back-link" style="display: none;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Back to Manual
            </a>
        </div>

        <div id="chatContainer" class="chat-container">
            <!-- Document Cover and Welcome Section (dynamically created when cover exists) -->

            <!-- Regular welcome message for documents without cover -->
            <div class="message assistant" id="regularWelcomeMessage" style="display: none;">
                <div class="message-content">
                    <strong id="regularWelcomeTitle" class="loading-text"></strong>
                    <div id="regularWelcomeContent"></div>
                </div>
            </div>
        </div>

        <!-- AI Hint Message (dismissible) -->
        <div class="ai-hint-message" id="aiHintMessage" style="display: none;">
            <span class="ai-hint-text">This tool is trained exclusively on the content of this specific document. By design it does not answer questions outside this document's scope or access external internet knowledge. For questions requiring broader information or general knowledge, please consult other reliable sources.</span>
            <button class="ai-hint-dismiss" id="aiHintDismiss" title="Dismiss">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>

        <!-- Single Input Container -->
        <div class="input-container">
            <input
                type="text"
                id="messageInput"
                placeholder="Ask a question..."
                autocomplete="off"
            >
            <button id="sendButton">Send</button>
        </div>
    </div>

    <!-- External Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- Application Scripts -->
    <script src="js/pubmed-api.js" type="module"></script>
    <script src="js/pubmed-popup.js" type="module"></script>
    <script src="js/document-selector.js" type="module"></script>
    <script src="js/mobile-menu.js" type="module"></script>
    <script src="js/main.js" type="module"></script>
</body>
</html>

