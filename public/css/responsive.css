/* ==================== RESPONSIVE STYLES ==================== */

/* Desktop: Enhanced header layout */
@media (min-width: 769px) {
    .header {
        padding: 32px 40px;
        background: #ffffff;
        box-shadow:
            0 1px 3px rgba(0, 0, 0, 0.06),
            0 8px 24px rgba(0, 0, 0, 0.12),
            0 0 0 1px rgba(255, 255, 255, 0.9),
            inset 0 1px 0 rgba(255, 255, 255, 0.6);
    }

    .header-logo {
        margin-right: 20px;
    }

    .header-center {
        margin: 0 20px;
    }

    .header h1 {
        font-size: 26px;
        font-family: 'Anton', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        font-weight: 400;
        letter-spacing: 0.025em;
        margin-bottom: 6px;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
        background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .header p {
        font-size: 15px;
        color: #64748b;
        margin-top: 0;
        font-weight: 400;
        letter-spacing: 0.01em;
    }

    .header-content {
        margin-top: 20px;
        display: flex;
        flex-direction: column;
        gap: 16px;
        align-items: center;
    }

    .back-link {
        align-self: center;
    }
}

/* Desktop: Enhanced header icons */
@media (min-width: 769px) {
    .about-icon {
        width: 32px;
        height: 32px;
        min-width: 32px;
        background: rgba(255, 255, 255, 0.95);
        border: 1px solid #e0e0e0;
        box-shadow: 0 2px 4px rgba(0,0,0,0.06);
    }

    .about-icon:hover {
        background: white;
        border-color: #cc0000;
        box-shadow: 0 3px 8px rgba(0,0,0,0.12);
    }

    .about-icon svg {
        width: 18px;
        height: 18px;
    }
}

/* Mobile responsiveness for cover and welcome layout */
@media (max-width: 768px) {
    .document-cover-and-welcome {
        flex-direction: column !important;
        gap: 15px;
        margin: 15px 16px; /* Add side margins for mobile */
        padding: 0;
        width: auto; /* Let it size naturally within container */
        align-items: stretch; /* Keep equal heights on mobile */
    }

    .document-cover-section {
        flex: none;
        width: 100%; /* Ensure full width */
        height: auto; /* Let height be fully responsive to image aspect ratio */
        padding: 12px; /* Card-like padding */
        margin: 0;
        display: flex;
        align-items: stretch;
        border-radius: 12px; /* More rounded for card appearance */
        overflow: hidden; /* Contain the image */
        background: white; /* Card background */
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); /* Card shadow */
        border: 1px solid #e9ecef; /* Subtle border */
    }

    .welcome-message-section {
        width: 100%; /* Ensure full width matches image container */
    }

    .welcome-message-section .message.assistant .message-content {
        width: 100%; /* Override max-width to ensure full width */
        max-width: 100%; /* Ensure it takes full container width */
    }

    .document-cover-image {
        width: 100%;
        height: auto; /* Let image determine height based on aspect ratio */
        object-fit: contain; /* Show full image without cropping */
        border-radius: 8px; /* Match container border radius */
        display: block;
    }

    .document-cover-overlay {
        border-radius: 0 0 8px 8px; /* Match mobile image border radius */
    }

    .document-cover-title {
        font-size: 14px; /* Slightly smaller on mobile */
    }

    .document-cover-meta {
        font-size: 12px; /* Smaller font size on mobile */
    }

    /* Multi-document cover grid responsive styles */
    .multi-document-cover-grid {
        margin: 15px 16px;
        padding: 0;
        gap: 15px;
    }

    .multi-doc-covers-grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 15px;
    }

    .multi-doc-cover-item {
        border-radius: 10px;
    }

    .multi-doc-cover-image-container {
        height: 140px;
    }

    .multi-doc-cover-overlay {
        padding: 10px;
    }

    .multi-doc-cover-title {
        font-size: 13px;
        margin-bottom: 3px;
    }

    .multi-doc-cover-meta {
        font-size: 11px;
    }

    .multi-doc-covers-header h3 {
        font-size: 20px;
    }

    .multi-doc-covers-header p {
        font-size: 14px;
    }
}

@media (max-width: 480px) {
    .document-cover-and-welcome {
        margin: 10px 12px; /* Add side margins for small screens */
        padding: 0;
        gap: 10px;
        width: auto; /* Let it size naturally within container */
    }

    .document-cover-section {
        width: 100%; /* Ensure full width */
        height: auto; /* Let height be fully responsive to image aspect ratio */
        padding: 8px; /* Slightly less padding on small screens */
        margin: 0;
        display: flex;
        align-items: stretch;
        border-radius: 10px; /* Slightly less rounded for small screens */
        overflow: hidden;
        background: white;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        border: 1px solid #e9ecef;
    }

    .welcome-message-section {
        width: 100%; /* Ensure full width matches image container */
    }

    .welcome-message-section .message.assistant .message-content {
        width: 100%; /* Override max-width to ensure full width */
        max-width: 100%; /* Ensure it takes full container width */
    }

    .document-cover-image {
        height: auto; /* Let image determine height based on aspect ratio */
        border-radius: 6px; /* Match container border radius */
    }

    /* Multi-document cover grid responsive styles for small screens */
    .multi-doc-covers-grid {
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 12px;
    }

    .multi-doc-cover-image-container {
        height: 120px;
    }

    .multi-doc-cover-overlay {
        padding: 8px;
    }

    .multi-doc-cover-title {
        font-size: 12px;
        margin-bottom: 2px;
    }

    .multi-doc-cover-meta {
        font-size: 10px;
    }

    .multi-doc-covers-header h3 {
        font-size: 18px;
    }

    .multi-doc-covers-header p {
        font-size: 13px;
    }
}

/* Mobile: Responsive header layout - Ultra compact */
@media (max-width: 768px) {
    .header {
        padding: 12px;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
        min-height: 60px;
        max-height: none;
        overflow: visible;
        transition: all 0.3s ease;
    }

    /* Hidden state for auto-hide behavior */
    .header.hidden {
        transform: translateY(-100%);
        opacity: 0;
        pointer-events: none;
    }

    /* Compact collapsed state */
    .header.collapsed {
        padding: 8px 12px;
        min-height: 50px;
        max-height: 50px;
    }

    /* Logo - minimal size */
    .header-logo {
        flex: 0 0 auto;
        order: -1;
        margin: 0;
        padding: 0;
    }

    .header-logo img {
        height: 36px !important;
        width: auto;
        max-width: 140px;
    }

    /* Center section - compact */
    .header-center {
        flex: 1;
        text-align: center;
        margin: 0;
        padding: 0 8px;
        min-width: 0; /* Allow text to shrink */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    .header-title-wrapper {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 4px;
        flex-wrap: nowrap;
    }

    .header h1 {
        font-size: 15px;
        font-weight: 600;
        line-height: 1.2;
        margin: 0;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 180px;
    }
    
    /* Subtitle on mobile */
    .header p {
        font-size: 11px;
        line-height: 1.2;
        margin: 2px 0 0 0;
    }

    .header-icons {
        flex-shrink: 0;
    }

    .about-icon {
        width: 20px !important;
        height: 20px !important;
        padding: 2px;
    }

    .about-icon svg {
        width: 12px !important;
        height: 12px !important;
    }

    /* User menu - prevent wrapping */
    .header-user-menu {
        flex: 0 0 auto;
        order: 2;
        margin: 0;
        padding: 0;
    }

    .user-menu-btn {
        padding: 4px;
        min-width: 32px;
        height: 32px;
    }

    .user-avatar svg {
        width: 16px;
        height: 16px;
    }

    .chevron-icon {
        width: 12px;
        height: 12px;
    }

    /* Document selector - compact */
    .header-document-selector {
        flex: 0 0 auto;
        order: 3;
        margin: 0;
        padding: 0;
    }

    .document-selector-btn {
        padding: 4px 8px;
        font-size: 12px;
        height: 32px;
        min-width: 32px;
    }

    .doc-icon {
        width: 14px;
        height: 14px;
    }

    .current-doc-name {
        font-size: 12px;
        max-width: 80px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    /* Subtitle styling handled above - keep visible on mobile */

    /* Header content - minimal */
    .header-content {
        margin-top: 8px;
        padding: 0 12px;
    }

    .back-link {
        font-size: 12px;
        padding: 4px 8px;
    }

    /* Mobile header toggle button */
    .mobile-header-toggle {
        position: fixed;
        top: 8px;
        left: 12px;
        z-index: 1001;
        width: 32px;
        height: 32px;
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 6px;
        display: none;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition: all 0.2s ease;
    }

    .mobile-header-toggle:hover {
        background: rgba(255, 255, 255, 1);
        transform: scale(1.05);
    }

    .mobile-header-toggle svg {
        width: 16px;
        height: 16px;
        color: #374151;
    }

    .mobile-header-toggle.show {
        display: flex;
    }

    /* Mobile Menu Toggle Button (Hamburger) */
    .mobile-menu-toggle {
        display: none;
        flex-direction: column;
        justify-content: space-between;
        width: 32px;
        height: 32px;
        padding: 6px;
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s ease;
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        order: 4; /* Place after everything else */
        margin-left: 8px;
    }

    .mobile-menu-toggle:hover {
        background: rgba(255, 255, 255, 1);
        transform: scale(1.05);
    }

    .mobile-menu-toggle span {
        display: block;
        width: 100%;
        height: 2px;
        background: #374151;
        border-radius: 2px;
        transition: all 0.3s ease;
    }

    .mobile-menu-toggle.active span:nth-child(1) {
        transform: translateY(7px) rotate(45deg);
    }

    .mobile-menu-toggle.active span:nth-child(2) {
        opacity: 0;
    }

    .mobile-menu-toggle.active span:nth-child(3) {
        transform: translateY(-7px) rotate(-45deg);
    }

    /* Hide desktop document selector and user menu on mobile when hamburger is shown */
    .mobile-menu-active .header-document-selector,
    .mobile-menu-active .header-user-menu {
        display: none !important;
    }
}

/* Mobile chat padding */
@media (max-width: 768px) {
    .chat-container {
        padding: 16px;
    }
}

/* Mobile message adjustments */
@media (max-width: 768px) {
    .message-content {
        max-width: 85%;
        padding: 12px 16px;
    }

    .message.assistant .message-content {
        max-width: 95%;
        padding: 16px 20px;
    }
}

/* Mobile table responsiveness */
@media (max-width: 768px) {
    .table-wrapper {
        box-shadow: 0 0 0 1px rgba(0,0,0,0.1);
        border-radius: 4px;
    }

    .message.assistant .message-content table {
        font-size: 13px;
        min-width: 600px; /* Force minimum width to enable scrolling */
        width: max-content; /* Let table size based on content */
    }

    .message.assistant .message-content table th,
    .message.assistant .message-content table td {
        padding: 8px 10px;
        white-space: nowrap; /* Prevent text wrapping in cells for better scrolling */
    }
}

    /* Mobile input adjustments */
@media (max-width: 768px) {
    .input-container {
        padding: 16px 20px;
        /* Enhanced mobile keyboard support - use max to avoid excessive padding */
        padding-bottom: max(16px, env(keyboard-inset-height, 16px));
        /* Ensure input stays visible above keyboard */
        position: sticky;
        bottom: 0;
        z-index: 1000;
    }
    
    /* Use dynamic viewport height for mobile */
    .container {
        height: 100dvh;
    }
    
    /* Ensure chat container adjusts to available space */
    .chat-container {
        height: calc(100dvh - env(keyboard-inset-height, 0px) - 200px);
        min-height: 200px;
    }
}

/* Mobile adjustments for AI hint */
@media (max-width: 768px) {
    .ai-hint-message {
        padding: 12px 20px;
        font-size: 14px;
        border-radius: 0 0 8px 8px;
        gap: 12px;
    }

    .ai-hint-dismiss svg {
        width: 12px;
        height: 12px;
    }
}

/* Mobile adjustments for about icon in header */
@media (max-width: 768px) {
    .header-icons {
        gap: 6px;
    }

    .about-icon {
        width: 24px;
        height: 24px;
    }

    .about-icon svg {
        width: 14px;
        height: 14px;
    }
}

/* Mobile adjustments */
@media (max-width: 768px) {
    .header-logo img {
        height: 56px;
        max-width: 180px;
        /* Maintain smooth transition on mobile */
        transition: opacity 0.3s ease;
    }

    .retrieval-selector {
        gap: 6px;
        margin-top: 10px;
    }

    .retrieval-btn {
        padding: 4px 10px;
        font-size: 11px;
    }
}

/* Mobile responsive */
@media (max-width: 768px) {
    .downloads-section {
        margin-top: 16px;
        padding-top: 16px;
    }

    .downloads-header {
        font-size: 13px;
    }

    .download-button {
        padding: 10px 14px;
    }

    .download-title {
        font-size: 13px;
    }

    .download-subtitle {
        font-size: 11px;
    }

    .download-action {
        font-size: 11px;
    }
}

/* Mobile responsiveness */
@media (max-width: 768px) {
    .pubmed-popup-content {
        max-width: calc(100vw - 32px);
        min-width: calc(100vw - 32px);
        margin: 16px;
    }

    .pubmed-popup-body {
        max-height: 60vh;
    }
}

/* Mobile Responsive Styles */
@media (max-width: 768px) {
    .document-selector-container {
        max-width: 100%;
    }

    /* Header document selector on mobile */
    .header-document-selector .document-selector-container {
        max-width: 100%;
    }

    /* Header document selector dropdown on mobile - full width */
    .header-document-selector .document-selector-dropdown {
        left: 0 !important;
        right: 0 !important;
        width: auto !important;
        max-width: none !important;
    }

    .document-selector-dropdown {
        position: absolute !important;
        top: calc(100% + 8px) !important;
        left: 0 !important;
        right: 0 !important;
        border-radius: 12px;
        max-height: 80vh;
        z-index: 999999;
    }

    .document-selector-dropdown.active {
        transform: translateY(0);
        pointer-events: auto;
    }

    .dropdown-header {
        padding: 20px;
    }

    .dropdown-header h3 {
        font-size: 18px;
    }

    .document-list {
        max-height: calc(80vh - 140px);
    }

    .document-item {
        padding: 16px 20px;
    }

    .document-item-title {
        font-size: 15px;
    }

    .document-item-subtitle {
        font-size: 13px;
    }
}

/* Mobile adjustments for fun facts */
@media (max-width: 768px) {
    .loading-container {
        padding: 16px 20px;
        gap: 12px;
    }

    .fun-fact {
        font-size: 12px;
        padding: 10px 12px;
    }
}
